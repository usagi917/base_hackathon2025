<svg xmlns="http://www.w3.org/2000/svg" width="1100" height="960" viewBox="0 0 1100 960" role="img" aria-labelledby="title desc">
  <title id="title">Proof of Regret - Sequence</title>
  <desc id="desc">Sequence of interactions between the apologizer, Frontend (DApp), Smart Contract (RegretVault), and the recipient.</desc>

  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L10,3 L0,6 Z" fill="#111827" />
    </marker>
    <marker id="arrowMuted" markerWidth="10" markerHeight="10" refX="10" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L10,3 L0,6 Z" fill="#6B7280" />
    </marker>
  </defs>

  <rect x="0" y="0" width="1100" height="960" fill="#FFFFFF" />

  <!-- Participant header boxes -->
  <g font-family="system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif" fill="#111827">
    <g>
      <rect x="40" y="32" width="220" height="44" rx="10" fill="#F3F4F6" stroke="#111827" />
      <text x="150" y="60" font-size="14" font-weight="700" text-anchor="middle">謝りたい人</text>
    </g>
    <g>
      <rect x="290" y="32" width="220" height="44" rx="10" fill="#F3F4F6" stroke="#111827" />
      <text x="400" y="60" font-size="14" font-weight="700" text-anchor="middle">Frontend (DApp)</text>
    </g>
    <g>
      <rect x="540" y="32" width="220" height="44" rx="10" fill="#F3F4F6" stroke="#111827" />
      <text x="650" y="60" font-size="14" font-weight="700" text-anchor="middle">Smart Contract (RegretVault)</text>
    </g>
    <g>
      <rect x="790" y="32" width="220" height="44" rx="10" fill="#F3F4F6" stroke="#111827" />
      <text x="900" y="60" font-size="14" font-weight="700" text-anchor="middle">謝罪を受ける人</text>
    </g>
  </g>

  <!-- Lifelines -->
  <g stroke="#9CA3AF" stroke-width="2" stroke-dasharray="6 6">
    <line x1="150" y1="88" x2="150" y2="920" />
    <line x1="400" y1="88" x2="400" y2="920" />
    <line x1="650" y1="88" x2="650" y2="920" />
    <line x1="900" y1="88" x2="900" y2="920" />
  </g>

  <!-- Notes -->
  <g font-family="system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif" font-size="13" fill="#111827">
    <g>
      <rect x="60" y="112" width="430" height="34" rx="8" fill="#FEF3C7" stroke="#D97706" />
      <text x="275" y="134" font-weight="700" text-anchor="middle">1. Confess &amp; Sacrifice</text>
    </g>
    <g>
      <rect x="60" y="324" width="930" height="34" rx="8" fill="#DBEAFE" stroke="#2563EB" />
      <text x="525" y="346" font-weight="700" text-anchor="middle">2. Share Link (Off-chain)</text>
    </g>
    <g>
      <rect x="560" y="430" width="430" height="34" rx="8" fill="#EDE9FE" stroke="#7C3AED" />
      <text x="775" y="452" font-weight="700" text-anchor="middle">3. Judgment</text>
    </g>
  </g>

  <!-- Messages -->
  <g font-family="system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif" fill="#111827">
    <!-- Confess & Sacrifice -->
    <line x1="150" y1="176" x2="400" y2="176" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="275" y="164" font-size="13" text-anchor="middle">メッセージ入力 &amp; ETH額指定</text>

    <line x1="400" y1="216" x2="650" y2="216" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="525" y="204" font-size="13" text-anchor="middle">deposit(message) + value: ETH</text>

    <line x1="650" y1="256" x2="400" y2="256" stroke="#6B7280" stroke-width="2" stroke-dasharray="5 4" marker-end="url(#arrowMuted)" />
    <text x="525" y="244" font-size="13" fill="#374151" text-anchor="middle">Return ID (Apology created)</text>

    <line x1="400" y1="296" x2="150" y2="296" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="275" y="284" font-size="13" text-anchor="middle">共有リンク生成 (/resolve/[id])</text>

    <!-- Share -->
    <line x1="150" y1="388" x2="900" y2="388" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="525" y="376" font-size="13" text-anchor="middle">リンクを送信 (DM等)</text>

    <!-- Judgment -->
    <line x1="900" y1="492" x2="400" y2="492" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="650" y="480" font-size="13" text-anchor="middle">リンクを開く</text>

    <line x1="400" y1="532" x2="650" y2="532" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="525" y="520" font-size="13" text-anchor="middle">getApology(id)</text>

    <line x1="650" y1="572" x2="400" y2="572" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="525" y="560" font-size="13" text-anchor="middle">Apology Details</text>

    <line x1="900" y1="612" x2="400" y2="612" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="650" y="596" font-size="12" text-anchor="middle">
      <tspan x="650" dy="0">決断を選択</tspan>
      <tspan x="650" dy="16">(Forgive / Reject / Punish)</tspan>
    </text>

    <line x1="400" y1="664" x2="650" y2="664" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="525" y="652" font-size="13" text-anchor="middle">resolve(id, decision)</text>

    <!-- Outcomes -->
    <line x1="650" y1="720" x2="900" y2="720" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="775" y="708" font-size="13" text-anchor="middle">Forgive: ETHを送金</text>

    <line x1="650" y1="760" x2="150" y2="760" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="400" y="748" font-size="13" text-anchor="middle">Reject: ETHを返金</text>

    <path d="M650 800 H740 V832 H650" fill="none" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="770" y="804" font-size="12" text-anchor="start">
      <tspan x="770" dy="0">Punish:</tspan>
      <tspan x="770" dy="16">ETHをBurn (0x0へ送金)</tspan>
    </text>

    <!-- SBT Minting -->
    <line x1="650" y1="880" x2="900" y2="880" stroke="#111827" stroke-width="2" marker-end="url(#arrow)" />
    <text x="775" y="868" font-size="13" text-anchor="middle">Mint Judgment SBT</text>
  </g>

  <!-- Caption -->
  <text x="60" y="938" font-family="system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif" font-size="12" fill="#6B7280">
    Source: README.md (static fallback for GitHub/Cursor Markdown preview)
  </text>
</svg>
